<%- contentFor('script') %>
<script src="/js/common/numerickey.js"></script>
<script src="/js/purchase/input.js"></script>
<script src="<%= gmoModuleUrl %>"></script>
<script>Multipayment.init('<%= gmoShopId %>');</script>
<%- contentFor('prev') %>
/purchase/ticket
<%- contentFor('body') %>
<div class="purchase-input">
    <h1 class="page-ttl"><%- __('purchase.input.page_ttl') %></h1>
    <p class="read"><%- __('purchase.input.read') %></p>
    <form id="purchaseform" method="post">
        <div class="form-layout center">
            <dl class="mb-middle">
                <dt><%- __('common.tel_num') %></dt>
                <dd>
                    <input type="tel" name="telNum" autocomplete="off" placeholder="<%- __('common.placeholder.tel') %>" value="<%= input.telNum %>" class="numerickeybord" readonly="readonly">
                </dd>
            </dl>
            <input type="hidden" name="lastNameHira" placeholder="<%- __('common.placeholder.lastNameHira') %>" value="">
            <input type="hidden" name="firstNameHira" placeholder="<%- __('common.placeholder.firstNameHira') %>" value="">
            <input type="hidden" name="mailAddr" placeholder="<%- __('common.placeholder.mail') %>" value="">
            <input type="hidden" name="mailConfirm" placeholder="<%- __('common.placeholder.mailConfirm') %>" value="">
            <% if (price > 0) { %>
            <h2 class="payment-ttl mb-small">
                <%- __('common.payment') %><span class="image credit-image"><img src="/images/default/common/credit_card.png" alt=""></span>
            </h2>
            <div class="box mb-small center credit-reader">
                <p class="small-x-text"><%- __('purchase.input.credit_reader') %></p>
                <div class="image"><img src="/images/fixed/card_reader.png" alt=""></div>
            </div>
            <dl class="mb-small">
                <dt><%- __('common.cardno') %></dt>
                <dd>
                    <input type="text" pattern="\d*" name="cardno" id="cardNumber" autocomplete="off" value="" maxlength="16" placeholder="<%- __('common.placeholder.cardno') %>">
                </dd>
            </dl>
            <div class="mb-small expire">
                <dl>
                    <dt><%- __('common.expire') %> / <%- __('common.month') %></dt>
                    <dd>
                        <select name="creditMonth" id="cardExpirationMonth">
                            <%
                            for (let i = 0; i < 12; i++) {
                                let num = i + 1;
                                let month = (num < 10) ? '0' + String(num) : String(num);
                            %>
                                <option value="<%= month %>"><%= month %></option>
                            <% } %>
                        </select>
                    </dd>
                </dl>
                <dl>
                    <dt><%- __('common.expire') %> / <%- __('common.year') %></dt>
                    <dd>
                        <select name="creditYear" id="cardExpirationYear">
                            <%
                            let choices = {};
                            let year2digits = moment().format('YY');
                            for (let i = 0; i < 10; i++) {
                                let key = (parseInt(year2digits) + i).toString();
                                choices[key] = `20${key}`;
                            }
                            %>
                            <% for (let key in choices) { %>
                            <option value="20<%- key %>"><%- choices[key] %></option>
                            <% } %>
                        </select>
                    </dd>
                </dl>
                <input type="hidden" name="expire" value="">
            </div>
            <dl class="mb-large securitycode">
                <dt><%- __('common.securitycode') %></dt>
                <dd>
                    <input type="text" pattern="\d*" name="securitycode" maxlength="4" autocomplete="off" value="" placeholder="<%- __('common.placeholder.securitycode') %>" class="numerickeybord numerickeybord-top" readonly="readonly">
                </dd>
            </dl>
            <input type="hidden" name="holdername" autocomplete="off" value="" placeholder="<%- __('common.placeholder.holdername') %>">
            <input type="hidden" name="gmoTokenObject" value="">
            <input type="hidden" name="gmoError" value="<%- (error && error.gmo) ? error.gmo.msg : '' %>">
            <input type="hidden" name="gmoErrorMessage" value="<%- (gmoError !== null) ? gmoError.message : '' %>">
            <% } %>
        </div>
        <div class="button middle-button next-button"><button class="center icon-triangle-01" type="submit"><%- __('purchase.input.next') %></button></div>
        <input type="hidden" name="transaction_id" value="<%= transactionId %>">
    </form>
    <input type="hidden" name="price" value="<%= price %>">
    <input type="hidden" name="validation" value="<%= JSON.stringify(error) %>">
    <input type="hidden" name="theaterCode" value="<%= performance.attributes.theater.id %>">
</div>

<%- include('../locales/validation') %>

<%- contentFor('modals') %>
<%- include('modals/validation') %>
<%- include('modals/securitycode') %>
<%- include('modals/creditcardAlert') %>
