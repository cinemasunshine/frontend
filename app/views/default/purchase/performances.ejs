<%- contentFor('script') %>
<% if (env === 'development') { %>
<script src="https://unpkg.com/vue"></script>
<% } else { %>
<script src="/js/common/vue.min.js"></script>
<% } %>

<%- contentFor('afterScript') %>
<script src="/js/purchase/performances.js"></script>
<%- contentFor('style') %>
<style>
    .navigation {
        display: none;
    }
</style>
<%- contentFor('prev') %>
/
<%- contentFor('body') %>
<div class="purchase-performances" id="performances">
    <h1 class="page-ttl"><%- __('purchase.performances.page_ttl') %></h1>
    <p class="read"><%- __('purchase.performances.read') %></p>
    <% for (const theater of movieTheaters) { %>
    <div class="mb-middle button blue-button center-button inquiry-button">
        <a href="/inquiry/login?theater=<%= theater.location.branchCode %>" target="_blank"><%= theater.location.name.ja %>照会ページ</a>
    </div>
    <% } %>
    
    <div class="center mb-middle d-table">
        <dl class="d-tr">
            <dt class="d-td"><%- __('purchase.performances.theater') %></dt>
            <dd class="d-td">
                <select v-model="theaterCode">
                    <% for (const theater of movieTheaters) { %>
                    <option v-bind:value="<%= theater.location.branchCode %>"><%= theater.location.name.ja %></option>
                    <% } %>
                </select>
            </dd>
        </dl>
        <dl class="d-tr">
            <dt class="d-td"><%- __('purchase.performances.date') %></dt>
            <dd class="d-td">
                <select v-model="date">
                    <template v-for="select in selects">
                        <option v-bind:value="select.value">{{select.text}}</option>
                    </template>
                </select>
            </dd>
        </dl>
    </div>

    <div class="sort mb-middle text-center">
        <div><a v-bind:class="{active: (sortType === 'chronological')}" v-on:click="onClickSort('chronological', $event)" href="#"><%- __('purchase.performances.sort.chronological') %></a></div>
        <div><a v-bind:class="{active: (sortType === 'film')}" v-on:click="onClickSort('film', $event)" href="#"><%- __('purchase.performances.sort.film') %></a></div>
    </div>

    <template v-if="error === null">
    <ul v-bind:class="{ active: sortType === 'chronological' }" class="chronological-order">
        <li v-for="order in chronologicalOrder" v-bind:key="order.identifier" class="button white-button mb-middle">
            <a v-on:click="onclickPerformance($event, order.identifier, order.coaInfo.titleCode)" class="icon-triangle-gray">
            <dl>
                <dt class="text-left">
                    <div>
                        <div class="mb-x-small"><strong class="large-x-text">{{ order.startDate | timeFormat(order.coaInfo.dateJouei) }}</strong></div>
                        <div>～{{ order.endDate | timeFormat(order.coaInfo.dateJouei) }}</div>
                    </div>
                    <div class="small-text text-center">
                        <div v-if="order.stockStatus === 0" class="mb-x-small"><%- __('purchase.performances.status.full') %></div>
                        <div v-else-if="order.stockStatus <= 10" class="mb-x-small"><%- __('purchase.performances.status.few') %></div>
                        <div v-else class="mb-x-small"><%- __('purchase.performances.status.many') %></div>
                        <div v-if="order.stockStatus === 0" class="status"><img src="/images/fixed/status_03.svg"></div>
                        <div v-else-if="order.stockStatus <= 10" class="status"><img src="/images/fixed/status_02.svg"></div>
                        <div v-else class="status"><img src="/images/fixed/status_01.svg"></div>
                    </div>
                </dt>
                <dd class="text-left">
                    <div class="screen-name mb-x-small small-text d-ib">{{ order.location.name.ja }}</div>
                    <div class="small-text mb-x-small d-ib">{{ order.workPerformed.duration | duration }}分</div>
                    <p><strong>{{ order.workPerformed.name }}</strong></p>
                </dd>
            </dl>
            </a>
        </li>
    </ul>
    
    <ul v-bind:class="{ active: sortType === 'film' }" class="film-order">
        <li v-for="order in filmOrder" v-bind:key="order.identifier" class="performance mb-x-small">
            <dl>
                <dt>
                    <div class="mb-x-small"><strong>{{ order.films[0].workPerformed.name }}</strong></div>
                    <div class="small-text">{{ order.films[0].workPerformed.duration | duration }}分</div>
                </dt>
                <dd>
                    <ul>
                        <li v-for="film in order.films" v-bind:key="film.identifier" class="button white-button">
                            <a v-on:click="onclickPerformance($event, film.identifier, film.coaInfo.titleCode)" class="icon-triangle-gray">
                                <dl>
                                    <dt>
                                        <div class="text-left">
                                            <div class="large-text mb-x-small"><strong>{{ film.startDate | timeFormat(film.coaInfo.dateJouei) }}</strong></div>
                                            <div>～{{ film.endDate | timeFormat(film.coaInfo.dateJouei) }}</div>
                                        </div>
                                        <div class="text-cente small-x-text">
                                            <div v-if="film.stockStatus === 0" class="mb-x-small"><%- __('purchase.performances.status.full') %></div>
                                            <div v-else-if="film.stockStatus <= 10" class="mb-x-small"><%- __('purchase.performances.status.few') %></div>
                                            <div v-else class="mb-x-small"><%- __('purchase.performances.status.many') %></div>
                                            <div v-if="film.stockStatus === 0" class="status"><img src="/images/fixed/status_03.svg"></div>
                                            <div v-else-if="film.stockStatus <= 10" class="status"><img src="/images/fixed/status_02.svg"></div>
                                            <div v-else class="status"><img src="/images/fixed/status_01.svg"></div>
                                        </div>
                                    </dt>
                                    <dd class="small-text text-center">
                                        <div class="screen-name">{{ film.location.name.ja }}</div>
                                    </dd>
                                </dl>
                            </a>
                        </li>
                    </ul>
                </dd>
            </dl>
        </li>
    </ul>
    </template>
    <p v-if="error !== null" class="text-center">{{ error }}</p>
</div>

