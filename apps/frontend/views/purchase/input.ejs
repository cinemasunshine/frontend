<% layout('../purchase/layout') -%>
<% block('script', '<script src="/js/purchase/input.js"></script>') -%>
<script src="<%= gmoModuleUrl %>"></script>
<script>Multipayment.init('<%= gmoShopId %>'); // トークンを利用するための api キー</script>
<div class="purchase-input">
    <h1 class="page-ttl">購入者情報入力</h1>
    <p class="read">
        ご希望の座席を選択して次へボタンを押してください。予約できる座席枚数は最大4席までとなります。<br>
        画面をタッチすると画面がズームしますので座席を選択してください。
    </p>

    <form id="purchaseform" method="post">
        <h2 class="section-ttl">お名前（漢字）</h2>
        <div class="box bg-light-gray">
            <dl>
                <dt>姓</dt>
                <dd>
                    <input type="text" name="last_name_kanji" value="<%= (info) ? info.last_name_kanji : '' %>">
                    <% if (error && error.last_name_kanji) { %>
                    <div class="validation"><%= error.last_name_kanji[0] %></div>
                    <% } %>
                </dd>
                <dt>名</dt>
                <dd>
                    <input type="text" name="first_name_kanji" value="<%= (info) ? info.first_name_kanji : '' %>">
                    <% if (error && error.first_name_kanji) { %>
                    <div class="validation"><%= error.first_name_kanji[0] %></div>
                    <% } %>
                </dd>
            </dl>
        </div>

        <h2 class="section-ttl">お名前（ひらがな）</h2>
        <div class="box bg-light-gray">
            <dl>
                <dt>せい</dt>
                <dd>
                    <input type="text" name="last_name_hira" value="<%= (info) ? info.last_name_hira : '' %>">
                    <% if (error && error.last_name_hira) { %>
                    <div class="validation"><%= error.last_name_hira[0] %></div>
                    <% } %>
                </dd>
                <dt>めい</dt>
                <dd>
                    <input type="text" name="first_name_hira" value="<%= (info) ? info.first_name_hira : '' %>">
                    <% if (error && error.first_name_hira) { %>
                    <div class="validation"><%= error.first_name_hira[0] %></div>
                    <% } %>
                </dd>
            </dl>
        </div>
        <h2 class="section-ttl">メールアドレス</h2>
        <div class="box bg-light-gray">
            <dl>
                <dd>
                    <input type="email" name="mail" value="<%= (info) ? info.mail : '' %>">
                    <% if (error && error.mail) { %>
                    <div class="validation"><%= error.mail[0] %></div>
                    <% } %>
                </dd>
            </dl>
            <dl>
                <dt>メールアドレス(確認)</dt>
                <dd>
                    <input type="text" name="mail_confirm" value="<%= (info) ? info.mail_confirm : '' %>">
                    <% if (error && error.mail_confirm) { %>
                    <div class="validation"><%= error.mail_confirm[0] %></div>
                    <% } %>
                </dd>
            </dl>
        </div>

        <h2 class="section-ttl">電話番号</h2>
        <div class="box bg-light-gray">
            <dl>
                <dd>
                    <input type="text" name="tel" value="<%= (info) ? info.tel : '' %>">
                    <% if (error && error.tel) { %>
                    <div class="validation"><%= error.tel[0] %></div>
                    <% } %>
                </dd>
            </dl>
        </div>

        <h2 class="section-ttl">お支払情報</h2>
        <ul class="box bg-light-gray">
            <li>
                <dl>
                    <dt>確認</dt>
                    <dd><strong>￥5,100</strong></dd>
                </dl>
            </li>
            <li>
                <dl>
                    <dt>カード番号</dt>
                    <dd>
                        <input type="text" name="cardno" maxlength="16" autocomplete="off" value="">
                    </dd>
                </dl>
            </li>
            <li>
                <dl>
                    <dt>カード有効期限</dt>
                    <dd>
                        <select name="credit_year">
                            <%
                            let choices = {};
                            let year2digits = moment().format('YY');
                            for (let i = 0; i < 10; i++) {
                                let key = (parseInt(year2digits) + i).toString();
                                choices[key] = `20${key}`;
                            }
                            %>
                            <% for (let key in choices) { %>
                            <option value="20<%- key %>"><%- choices[key] %></option>
                            <% } %>
                        </select> 年 
                        <select name="credit_month">
                            <%
                            for (let i = 0; i < 12; i++) {
                                let num = i + 1;
                                let month = (num < 10) ? '0' + String(num) : String(num);
                            %>
                                <option value="<%= month %>"><%= month %></option>
                            <% } %>
                        </select> 月 
                        <input type="hidden" name="expire" value="">
                    </dd>
                </dl>
            </li>
            <li>
                <dl>
                    <dt>カード名義人</dt>
                    <dd>
                        <input type="text" name="holdername" value="">
                    </dd>
                </dl>
            </li>
            <li>
                <dl>
                    <dt>セキュリティーコード</dt>
                    <dd>
                        <input type="text" name="securitycode" value="">
                    </dd>
                </dl>
            </li>
        </ul>
        <input type="hidden" name="gmo_token_object" value="">
        <div class="button-area clearfix">
            <div class="button next-button blue-button"><button type="submit">次へ</button></div>
            <div class="prev-link"><a href="<%- url('purchase.ticket') %>">戻る</a></div>
        </div>
        <input type="hidden" name="reservationNo" value="<%= reservationNo %>">
    </form>
</div>